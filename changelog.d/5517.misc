Flattening the asynchronous onboarding state and passing all errors through the same pipeline